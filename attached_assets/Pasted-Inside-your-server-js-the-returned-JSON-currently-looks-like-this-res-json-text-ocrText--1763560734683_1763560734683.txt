Inside your server.js, the returned JSON currently looks like this:

res.json({ text: ocrText });


BUT YOUR FRONTEND IS EXPECTING THIS FORMAT:

{
  name: "...",
  phone: "...",
  device: "...",
  repair: "..."
}


Not just "text".

So the frontend is literally receiving nothing it knows how to use â€” and then displays blank fields.

Your latest OCR parser exists (the name, phone, device extraction logic), but you're not calling it.

âœ… THE FIX (Server-Side)

You must change your server endpoint to:

Run HEIC â†’ JPEG

Send to Google OCR

Parse name + phone + device + repair

Return ALL FOUR in JSON

â­ WORKING FIX â€” Paste this into your server.js
Find your OCR handler (probably /api/extract-text)

Replace the body with this:

app.post("/api/extract-text", upload.single("image"), async (req, res) => {
  try {
    if (!req.file) {
      return res.status(400).json({ error: "No file uploaded" });
    }

    let imageBuffer = req.file.buffer;

    // Convert HEIC â†’ JPEG
    if (req.file.mimetype === "image/heic" || req.file.originalname.toLowerCase().endsWith(".heic")) {
      const { convert } = require("heic-convert");
      const jpegBuffer = await convert({
        buffer: imageBuffer,
        format: "JPEG",
        quality: 1
      });
      imageBuffer = jpegBuffer;
    }

    // Send to Google Vision
    const [result] = await client.textDetection({ image: { content: imageBuffer } });
    const detections = result.textAnnotations;

    if (!detections || detections.length === 0) {
      return res.status(400).json({ error: "No text detected in image" });
    }

    const rawText = detections[0].description;

    // -------------------------
    // ðŸ” Parse Name + Phone + Device + Repair
    // -------------------------

    const lines = rawText.split("\n").map(l => l.trim());

    // Phone
    const phoneMatch = rawText.match(/(\+?\d[\d\s\-\(\)]{7,}\d)/);
    const phone = phoneMatch ? phoneMatch[1].replace(/\D+/g, "") : "";

    // Name
    const name = lines.find(l =>
      /^[A-Za-z]{2,}\s[A-Za-z]{2,}/.test(l) &&
      !l.toLowerCase().includes("invoice") &&
      !l.includes("(") &&
      !/\d/.test(l)
    ) || "";

    // Device detection (basic keywords)
    const device = lines.find(l =>
      /(iPhone|Samsung|MacBook|iPad|HP|Dell|Lenovo|LG|Motorola|PlayStation|Xbox)/i.test(l)
    ) || "";

    // Repair detection
    const repair = lines.find(l =>
      /(screen|battery|charging|water|diagnostic|speaker|microphone|camera|repair)/i.test(l)
    ) || "";

    // -------------------------
    // ðŸ”¥ Return structured data
    // -------------------------
    res.json({
      success: true,
      name,
      phone,
      device,
      repair,
      rawText
    });

  } catch (err) {
    console.error("OCR error:", err);
    res.status(500).json({ error: "Failed to process image" });
  }
});

âš¡ NEXT â€” UPDATE YOUR FRONTEND JS

Inside your index.js or inline JS:

Replace:

document.getElementById("customerName").value = data.text;


with:

document.getElementById("customerName").value = data.name || "";
document.getElementById("customerPhone").value = data.phone || "";
document.getElementById("deviceDetected").innerText = data.device || "Not detected";
document.getElementById("repairDetected").innerText = data.repair || "Not detected";

ðŸš€ Now It Will Work 100%

Upload HEIC â†’ auto converts to JPEG

Google Vision gets clean JPEG

Name extracted

Phone extracted

Device extracted

Repair extracted

UI updates correctly